name: "wazuhl_DQN"
layer {
  name: "experience_replay_state"
  type: "MemoryData"
  top: "data"
  top: "redundant1"
  include {
    phase: TRAIN
  }
  memory_data_param 
  {
    batch_size: ${MINIBATCH_SIZE}
    channels: ${NUMBER_OF_FEATURES}
    height: 1
    width: 1
  }
}
layer {
  name: "live_input"
  type: "MemoryData"
  top: "data"
  top: "redundant2"
  include {
    phase: TEST
  }
  memory_data_param 
  {
    batch_size: 1
    channels: ${NUMBER_OF_FEATURES}
    height: 1
    width: 1
  }
}

layer {
  name: "norm"
  type: "BatchNorm"
  bottom: "data"
  top: "norm_data"
}
layer {
  name: "ip1"
  type: "InnerProduct"
  bottom: "norm_data"
  top: "ip1"
  inner_product_param {
    num_output: ${HIDDEN_SIZE}
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "ip1"
  top: "relu1"
}
layer {
  name: "ip2"
  type: "InnerProduct"
  bottom: "relu1"
  top: "ip2"
  inner_product_param {
    num_output: ${HIDDEN_SIZE}
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "ip2"
  top: "relu2"
}
layer {
  name: "ip3"
  type: "InnerProduct"
  bottom: "relu2"
  top: "ip3"
  inner_product_param {
    num_output: ${NUMBER_OF_ACTIONS}
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
  }
}
layer {
  name: "tanh"
  type: "TanH"
  bottom: "ip3"
  top: "tanh"
}
layer {
  name: "scale"
  type: "Scale"
  bottom: "tanh"
  top: "Q_values"
  scale_param {
    filler {
      type: "constant"
      value: 1.0
    }
    bias_term: true
    bias_filler {
      type: "constant"
      value: 0.0
    }
  }
}
layer {
  name: "experience_replay_action"
  type: "MemoryData"
  top: "experience_replay_action"
  top: "redundant3"
  include {
    phase: TRAIN
  }
  memory_data_param 
  {
    batch_size: ${MINIBATCH_SIZE}
    channels: 1 
    height: 1
    width: ${NUMBER_OF_ACTIONS}
  }
}
layer {
  name: "silence_train"
  type: "Silence"
  bottom: "redundant1"
  bottom: "redundant3"
  include {
    phase: TRAIN
  }
}
layer {
  name: "silence_test"
  type: "Silence"
  bottom: "redundant2"
  include {
    phase: TEST
  }
}
layer {
  name: "loss"
  type: "EuclideanLoss"
  bottom: "Q_values"
  bottom: "experience_replay_action"
  top: "loss"
  include {
    phase: TRAIN
  }
}
